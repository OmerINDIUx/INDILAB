<!DOCTYPE html>
<html lang="es">
  <head>
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <link id="menu-css" rel="stylesheet" href="/css/index.css" />
    <link
      id="menu-header-css"
      rel="stylesheet"
      href="/css/components/menu-header.css"
    />

    <meta charset="UTF-8" />
    <title>INDI Lab</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Some examples for how sticky sections can be animated."
    />
    <meta
      name="keywords"
      content="sticky, css, gsap, animation, sticky section, layout"
    />
    <meta name="author" content="Codrops" />

    <!-- Fuentes -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fontfaceobserver/2.1.0/fontfaceobserver.standalone.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />

    <!-- ✅ GSAP y plugins: una sola versión y en orden correcto -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/TextPlugin.min.js"></script>

    <script>
      document.documentElement.className = "js";
    </script>

    <!-- ✅ Mantengo solo una versión de estos scripts locales -->
    <!-- (Quité /js/ScrollTrigger.min.js y el gsap.min.js local para evitar conflictos) -->
    <script src="/js/lenis.min.js"></script>
    <script src="/js/splitting.min.js"></script>

    <script type="module" src="js/demo4/traduction.js"></script>
  </head>

  <body>
    <!-- ❌ Eliminado el primer script de resize que hacía location.reload() -->

    <section id="brand-hero" class="brand">
      <div id="svg-wrapper">
        <!-- SVG inicial (cuadrado) -->
        <div id="svg-square" class="svg-containedor"></div>
        <!-- SVG destino (rectángulo, oculto al inicio) -->
        <div id="svg-rect" class="svg-containedor hidden"></div>
      </div>
      <div class="navigation-arrows2">
        <h2 data-i18n="Co-creating the future"></h2>
      </div>
    </section>

    <script>
      gsap.registerPlugin(ScrollTrigger);

      gsap.to(".navigation-arrows2 h2", {
        opacity: 0,
        y: -15, // movimiento mínimo para que se sienta natural
        ease: "none",
        scrollTrigger: {
          trigger: ".navigation-arrows2",
          start: "top bottom",
          end: "bottom top",
          scrub: true,
        },
      });
    </script>

    <!-- ---------------------aquí inicia el HeroMap------------------------------------------- -->

    <section id="map" class="main-content">
      <div class="stay">
        <!-- ✅ ID cambiado para no repetir "brand" -->
        <div id="brand-layout" class="layout">
          <!-- COLUMNA IZQUIERDA -->
          <div id="left-column" class="left-column">
            <div id="content-row">
              <div class="content--intro">
                <p class="text-large_w">
                  <span data-i18n="hero_intro_text"></span> <br />
                  <span data-i18n="hero_intro_text1"></span><br />
                  <span data-i18n="hero_intro_text2"></span>
                </p>
              </div>
            </div>

            <script>
              // SVGs loaded by global.js
            </script>
          </div>

          <div id="maping-contorler" class="right-column">
            <video
              id="trafficVideo"
              class="mapa_video"
              preload="auto"
              muted
              playsinline
            ></video>
            <div class="center-controls">
              <div class="time-slider-box">
                <p class="text-large_M">
                  <mark class="hx-1 hx-2" data-i18n="CDMX Traffic"></mark>
                </p>
                <span id="hourLabel" class="hour">--:--</span>
                <input id="hourSlider" type="range" min="0" max="23" step="1" />
                <div class="video-footer">
                  <p class="map_food" data-i18n="cdmx traffic page food1"></p>
                  <p class="map_food" data-i18n="cdmx traffic page food2"></p>
                  <p class="map_food" data-i18n="cdmx traffic page food3"></p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <script src="js/demo4/script_map.js"></script>
    </section>

    <section class="text-image-section2">
      <div class="container2">
        <div class="text-column2">
          <h2 class="title2"></h2>
          <p class="text-content2"></p>
        </div>
        <div class="image-column2">
          <div class="content__img-wrapper2"></div>
        </div>
      </div>
    </section>

    <style>
      .title2 span {
        display: block;
      }
    </style>

    <script src="js/demo4/revealTextImages.js"></script>

    <section class="calltoaction-section">
      <div class="secundary-logo">
        <div class="indi-lab-logo" data-svg="svg/Secundary_Brand.svg"></div>
      </div>

      <script>
        // SVGs loaded by global.js
      </script>

      <div>
        <div class="content content--highlight content--outro section">
          <p class="text-large_w" data-i18n="text of the to Action"></p>
        </div>
      </div>

      <div class="navigation-arrows-whatwedo">
        <a href="/Who_We_Are.html" class="our-projects">
          <img
            src="svg/brand_icon_right.svg"
            alt="Brand Icon Back"
            class="brand-icon-back"
          />
          <h3 data-i18n="menu about"></h3>
        </a>
      </div>
    </section>

    <!-- ---------------------aquí inicia esl código------------------------------------------- -->
    <div class="navigation-arrows">
      <a href="#map">
        <div class="core-belive">
          <img
            src="svg/brand_icon_back.svg"
            alt="Brand Icon Back"
            class="brand-icon-back"
          />
          <h3 data-i18n="menu home"></h3>
        </div>
      </a>

      <a href="/What_We_Do.html">
        <div class="our-projects">
          <img
            src="svg/brand_icon_right.svg"
            alt="Brand Icon Back"
            class="brand-icon-back"
          />
          <h3 data-i18n="Our work"></h3>
        </div>
      </a>
    </div>

    <div class="scroll-animation">
      <img src="img/Scroll Down.gif" alt="scroll down" />
    </div>

    <!-- ------js funcionales sin llamdos html---------- -->
    <script class="branding" src="js/demo4/animation_brand.js"></script>
    <script src="js/demo4/miniscritps.js"></script>
    <script src="js/demo4/RaditionAndWheather.js"></script>
    <script src="js/demo4/butoms_prueba.js"></script>

    <div class="menu-placeholder" id="menu-placeholder"></div>

    <script>
      // Menu loaded by global.js
    </script>

    <!-- ✅ Un solo manejador de resize, con isMobileDevice y restauración de scroll -->
    <!-- Global JS -->
    <script src="/js/global.js"></script>
    <section class="contact-next-project">
      <!-- Newsletter -->
      <div class="newsletter-block">
        <h2 data-i18n="newsletter_title"></h2>
        <p data-i18n="newsletter_desc"></p>

        <form id="newsletter-form" novalidate>
          <label for="nm-email" data-i18n="newsletter_email_label"></label>
          <input
            id="nm-email"
            name="email"
            type="email"
            required
            data-i18n="newsletter_email_placeholder"
          />

          <label for="nm-name" data-i18n="newsletter_name_label"></label>
          <input
            id="nm-name"
            name="name"
            type="text"
            data-i18n="newsletter_name_placeholder"
          />

          <div class="policy">
            <input id="nm-policy" name="policy" type="checkbox" required />
            <label for="nm-policy">
              <span data-i18n="newsletter_policy_accept"></span>
              <a
                href="/politica-privacidad.html"
                target="_blank"
                rel="noopener"
                data-i18n="newsletter_policy_link"
              ></a>
            </label>
          </div>

          <button
            type="submit"
            class="newsletter-btn"
            data-i18n="newsletter_btn"
          ></button>

          <div id="nm-message"></div>

          <div class="social">
            <a
              href="https://www.instagram.com/indixlab/"
              target="_blank"
              aria-label="Instagram"
            >
              <i class="fab fa-instagram"></i>
            </a>
            <a
              href="https://www.facebook.com/people/INDIxLab/61582923939627/?locale=es_LA"
              target="_blank"
              aria-label="Facebook"
            >
              <i class="fab fa-facebook-f"></i>
            </a>
            <a
              href="https://x.com/INDIxLab"
              target="_blank"
              aria-label="Twitter"
            >
              <i class="fab fa-x-twitter"></i>
            </a>
            <a
              href="https://www.linkedin.com/company/indixlab"
              target="_blank"
              aria-label="LinkedIn"
            >
              <i class="fab fa-linkedin-in"></i>
            </a>
          </div>
        </form>
      </div>

      <aside class="next-project-block">
        <h3 data-i18n="next_project_title">Next Projects</h3>
        <article class="project-card">
          <img
            src="/projects/ViviendaModular/images/electromovilidad.png"
            alt="Miniatura proyecto siguiente"
          />
          <div class="project-card__body">
            <h4 data-i18n="Urban Heat Islands"></h4>
            <p data-i18n="project_card_link"></p>
          </div>
        </article>
        <article class="project-card">
          <img
            src="/projects/ViviendaModular/images/Generated Image September 09, 2025 - 2_24PM.png"
            alt="Miniatura proyecto siguiente"
          />
          <div class="project-card__body">
            <h4 data-i18n="Urban Heat Islands"></h4>
            <p data-i18n="project_card_link"></p>
          </div>
        </article>
      </aside>

      <script>
        (function () {
          const form = document.getElementById("newsletter-form");
          const email = document.getElementById("nm-email");
          const policy = document.getElementById("nm-policy");
          const msg = document.getElementById("nm-message");

          function show(message, ok = true) {
            msg.textContent = message;
            msg.style.color = ok ? "#0a0" : "#c00";
          }

          form.addEventListener("submit", function (e) {
            e.preventDefault();
            msg.textContent = "";

            if (!email.value || !/\S+@\S+\.\S+/.test(email.value)) {
              show("Introduce un correo válido.", false);
              email.focus();
              return;
            }
            if (!policy.checked) {
              show("Debes aceptar la política de privacidad.", false);
              return;
            }

            const payload = {
              email: email.value.trim(),
              name: (document.getElementById("nm-name").value || "").trim(),
              acceptedPolicy: true,
              source: window.location.pathname,
            };

            fetch("/api/subscribe", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(payload),
            })
              .then((resp) => {
                if (!resp.ok) throw new Error("network");
                return resp.json().catch(() => ({}));
              })
              .then(() => {
                show("Gracias por suscribirte. Revisa tu correo.", true);
                form.reset();
              })
              .catch(() => {
                try {
                  const pending = JSON.parse(
                    localStorage.getItem("newsletter_pending") || "[]"
                  );
                  pending.push(payload);
                  localStorage.setItem(
                    "newsletter_pending",
                    JSON.stringify(pending)
                  );
                } catch (err) {}
                show(
                  "Suscripción guardada localmente. Se intentará enviar cuando haya conexión.",
                  true
                );
                form.reset();
              });
          });
        })();
      </script>
    </section>
  </body>
</html>
