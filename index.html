<!DOCTYPE html>
<html lang="es">
  <head>
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <link id="menu-css" rel="stylesheet" href="/css/index.css" />
    <link
      id="menu-css"
      rel="stylesheet"
      href="/css/components/menu-header.css"
    />

    <meta charset="UTF-8" />
    <title>INDI Lab</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Some examples for how sticky sections can be animated."
    />
    <meta
      name="keywords"
      content="sticky, css, gsap, animation, sticky section, layout"
    />
    <meta name="author" content="Codrops" />

    <!-- Fuentes -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fontfaceobserver/2.1.0/fontfaceobserver.standalone.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />

    <!-- ✅ GSAP y plugins: una sola versión y en orden correcto -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/TextPlugin.min.js"></script>

    <script>
      document.documentElement.className = "js";
    </script>

    <!-- ✅ Mantengo solo una versión de estos scripts locales -->
    <!-- (Quité /js/ScrollTrigger.min.js y el gsap.min.js local para evitar conflictos) -->
    <script src="/js/lenis.min.js"></script>
    <script src="/js/splitting.min.js"></script>

    <script type="module" src="js/demo4/traduction.js"></script>
  </head>

  <body>
    <!-- ❌ Eliminado el primer script de resize que hacía location.reload() -->

    <section id="brand-hero" class="brand">
      <div id="svg-wrapper">
        <!-- SVG inicial (cuadrado) -->
        <div id="svg-square" class="svg-containedor"></div>
        <!-- SVG destino (rectángulo, oculto al inicio) -->
        <div id="svg-rect" class="svg-containedor hidden"></div>
      </div>
      <div class="navigation-arrows2">
        <h2 data-i18n="Co-creating the futurehhhhhhhhhhhhhhhhhh"></h2>
      </div>
    </section>

    <script>
      gsap.registerPlugin(ScrollTrigger);

      gsap.to(".navigation-arrows2 h2", {
        opacity: 0,
        y: -15, // movimiento mínimo para que se sienta natural
        ease: "none",
        scrollTrigger: {
          trigger: ".navigation-arrows2",
          start: "top bottom",
          end: "bottom top",
          scrub: true,
        },
      });
    </script>

    <!-- ---------------------aquí inicia el HeroMap------------------------------------------- -->

    <section id="map" class="main-content">
      <div class="stay">
        <!-- ✅ ID cambiado para no repetir "brand" -->
        <div id="brand-layout" class="layout">
          <!-- COLUMNA IZQUIERDA -->
          <div id="left-column" class="left-column">
            <div id="content-row">
              <div class="content--intro">
                <p class="text-large_w">
                  <span data-i18n="hero_intro_text"></span> <br />
                  <span data-i18n="hero_intro_text1"></span><br />
                  <span data-i18n="hero_intro_text2"></span>
                </p>
              </div>
            </div>

            <script>
              document.querySelectorAll(".corner").forEach((container) => {
                const url = container.dataset.svg;
                fetch(url)
                  .then((r) => r.text())
                  .then((svg) => (container.innerHTML = svg))
                  .catch((err) => console.error(`Error cargando ${url}`, err));
              });
            </script>
          </div>

          <div id="maping-contorler" class="right-column">
            <video
              id="trafficVideo"
              class="mapa_video"
              preload="auto"
              muted
              playsinline
            ></video>
            <div class="center-controls">
              <div class="time-slider-box">
                <p class="text-large_M">
                  <mark class="hx-1 hx-2" data-i18n="CDMX Traffic"></mark>
                </p>
                <span id="hourLabel" class="hour">--:--</span>
                <input id="hourSlider" type="range" min="0" max="23" step="1" />
                <div class="video-footer">
                  <p class="map_food" data-i18n="cdmx traffic page food1"></p>
                  <p class="map_food" data-i18n="cdmx traffic page food2"></p>
                  <p class="map_food" data-i18n="cdmx traffic page food3"></p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <script src="js/demo4/script_map.js"></script>
    </section>

    <section class="text-image-section2">
      <div class="container2">
        <div class="text-column2">
          <h2 class="title2"></h2>
          <p class="text-content2"></p>
        </div>
        <div class="image-column2">
          <div class="content__img-wrapper2"></div>
        </div>
      </div>
    </section>

    <style>
      .title2 span {
        display: block;
      }
    </style>

    <script src="js/demo4/revealTextImages.js"></script>

    <section class="calltoaction-section">
      <div class="secundary-logo">
        <div class="indi-lab-logo" data-svg="svg/Secundary_Brand.svg"></div>
      </div>

      <script>
        document.addEventListener("DOMContentLoaded", () => {
          document.querySelectorAll("[data-svg]").forEach((el) => {
            const svgPath = el.getAttribute("data-svg");
            fetch(svgPath)
              .then((res) => res.text())
              .then((svgContent) => {
                el.innerHTML = svgContent;
              })
              .catch((err) => console.error("Error cargando SVG:", err));
          });
        });
      </script>

      <div>
        <div class="content content--highlight content--outro section">
          <p class="text-large_w" data-i18n="text of the to Action"></p>
        </div>
      </div>

      <div class="navigation-arrows-whatwedo">
        <a href="/Who_We_Are.html" class="our-projects">
          <img
            src="svg/brand_icon_right.svg"
            alt="Brand Icon Back"
            class="brand-icon-back"
          />
          <h3 data-i18n="menu about"></h3>
        </a>
      </div>
    </section>

    <!-- ---------------------aquí inicia esl código------------------------------------------- -->
    <div class="navigation-arrows">
      <a href="#map">
        <div class="core-belive">
          <img
            src="svg/brand_icon_back.svg"
            alt="Brand Icon Back"
            class="brand-icon-back"
          />
          <h3 data-i18n="menu home"></h3>
        </div>
      </a>

      <a href="/Who_We_Are.html">
        <div class="our-projects">
          <img
            src="svg/brand_icon_right.svg"
            alt="Brand Icon Back"
            class="brand-icon-back"
          />
          <h3 data-i18n="menu about"></h3>
        </div>
      </a>
    </div>

    <div class="scroll-animation">
      <img src="img/Scroll Down.gif" alt="scroll down" />
    </div>

    <!-- ------js funcionales sin llamdos html---------- -->
    <script class="branding" src="js/demo4/animation_brand.js"></script>
    <script src="js/demo4/miniscritps.js"></script>
    <script src="js/demo4/RaditionAndWheather.js"></script>
    <script src="js/demo4/butoms_prueba.js"></script>

    <div class="menu-placeholder" id="menu-placeholder"></div>

    <script>
      fetch("/menu.html")
        .then((response) => {
          if (!response.ok) {
            throw new Error(
              `Error al cargar el menú: ${response.status} ${response.statusText}`
            );
          }
          return response.text();
        })
        .then((data) => {
          const placeholder = document.getElementById("menu-placeholder");
          if (!placeholder) {
            throw new Error(
              "Elemento con id 'menu-placeholder' no encontrado en el DOM"
            );
          }
          placeholder.innerHTML = data;

          const script = document.createElement("script");
          script.src = "/js/demo4/menu.js";
          script.onload = () => console.log("menu.js cargado correctamente ✅");
          script.onerror = () =>
            console.error("Error al cargar /js/demo4/menu.js ❌");
          document.body.appendChild(script);

          if (window.applyTranslations) {
            window.applyTranslations();
          }
        })
        .catch((error) => {
          console.error("Ocurrió un error al cargar el menú:", error);
        });
    </script>

    <!-- ✅ Un solo manejador de resize, con isMobileDevice y restauración de scroll -->
    <script>
      (function () {
        function isMobileDevice() {
          const byWidth = window.innerWidth < 768;
          const hasTouch =
            "ontouchstart" in window ||
            navigator.maxTouchPoints > 0 ||
            navigator.msMaxTouchPoints > 0;
          const ua = (
            navigator.userAgent ||
            navigator.vendor ||
            window.opera
          ).toLowerCase();
          const isUA =
            /android|iphone|ipad|ipod|opera mini|iemobile|mobile/.test(ua);
          return (byWidth && hasTouch) || isUA;
        }

        let resizeTimeout;

        window.addEventListener("resize", () => {
          // Evita recargar en móviles para no romper la experiencia
          if (isMobileDevice()) return;

          clearTimeout(resizeTimeout);

          resizeTimeout = setTimeout(() => {
            // Guardar posición actual del scroll
            sessionStorage.setItem("scrollPosition", window.scrollY);

            // Recargar la página
            location.reload();
          }, 300);
        });

        // Al cargar la página, restaurar la posición
        window.addEventListener("load", () => {
          const scrollPos = sessionStorage.getItem("scrollPosition");
          if (scrollPos !== null) {
            window.scrollTo(0, parseInt(scrollPos, 10));
            sessionStorage.removeItem("scrollPosition");
          }
        });
      })();
    </script>
  </body>
</html>
